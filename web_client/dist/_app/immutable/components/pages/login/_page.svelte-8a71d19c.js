import{S as te,i as ae,s as re,k as r,q as D,a as v,l as n,m as p,r as F,h as u,c as b,n as T,b as ne,F as e,M as H,I as J,J as ge,A as X,K as ve,v as ue,w as de,x as fe,f as pe,N as ye,t as ce,O as he,y as _e}from"../../../chunks/index-f7b1ee1a.js";import{a as me}from"../../../chunks/index-5d397866.js";import{U as ee,a as be,b as we}from"../../../chunks/tokens-57bcebed.js";function Ee(c){let t,l,o,s,d,w,i,a,f,_,S,k,h,B,y,N,G,j,m,M,O,C,U,V,P,K;return{c(){t=r("div"),l=r("header"),o=r("h2"),s=D("Login"),d=v(),w=r("hr"),i=v(),a=r("form"),f=r("label"),_=r("strong"),S=D("Username"),k=v(),h=r("input"),B=v(),y=r("label"),N=r("strong"),G=D("Password"),j=v(),m=r("input"),M=v(),O=r("br"),C=v(),U=r("button"),V=D("Login"),this.h()},l($){t=n($,"DIV",{class:!0});var E=p(t);l=n(E,"HEADER",{});var I=p(l);o=n(I,"H2",{});var z=p(o);s=F(z,"Login"),z.forEach(u),I.forEach(u),d=b(E),w=n(E,"HR",{}),i=b(E),a=n(E,"FORM",{});var L=p(a);f=n(L,"LABEL",{});var q=p(f);_=n(q,"STRONG",{});var R=p(_);S=F(R,"Username"),R.forEach(u),k=b(q),h=n(q,"INPUT",{type:!0}),q.forEach(u),B=b(L),y=n(L,"LABEL",{});var g=p(y);N=n(g,"STRONG",{});var Q=p(N);G=F(Q,"Password"),Q.forEach(u),j=b(g),m=n(g,"INPUT",{type:!0}),g.forEach(u),M=b(L),O=n(L,"BR",{}),C=b(L),U=n(L,"BUTTON",{class:!0,type:!0});var W=p(U);V=F(W,"Login"),W.forEach(u),L.forEach(u),E.forEach(u),this.h()},h(){T(h,"type","text"),T(m,"type","password"),T(U,"class","is-full-width"),T(U,"type","submit"),T(t,"class","card svelte-6fs8o2")},m($,E){ne($,t,E),e(t,l),e(l,o),e(o,s),e(t,d),e(t,w),e(t,i),e(t,a),e(a,f),e(f,_),e(_,S),e(f,k),e(f,h),H(h,c[0]),e(a,B),e(a,y),e(y,N),e(N,G),e(y,j),e(y,m),H(m,c[1]),e(a,M),e(a,O),e(a,C),e(a,U),e(U,V),P||(K=[J(h,"input",c[3]),J(m,"input",c[4]),J(a,"submit",ge(c[2]))],P=!0)},p($,[E]){E&1&&h.value!==$[0]&&H(h,$[0]),E&2&&m.value!==$[1]&&H(m,$[1])},i:X,o:X,d($){$&&u(t),P=!1,ve(K)}}}function Re(c,t,l){let o="",s="";async function d(){let a=new FormData;a.append("username",o),a.append("password",s);let f=await fetch(ee.login,{method:"POST",body:a,credentials:"include"});if(f.ok){let _=await f.json();be.set(_.access_token);let S=document.referrer;await we(S.length>0?S:"/",{replaceState:!0}),location.reload();return}console.error("Login failed",await f.json())}function w(){o=this.value,l(0,o)}function i(){s=this.value,l(1,s)}return[o,s,d,w,i]}class $e extends te{constructor(t){super(),ae(this,t,Re,Ee,re,{})}}function Pe(c){let t,l,o,s,d,w,i,a,f,_,S,k,h,B,y,N,G,j,m,M,O,C,U,V,P,K,$,E,I,z,L,q;return{c(){t=r("div"),l=r("header"),o=r("h2"),s=D("Register"),d=v(),w=r("hr"),i=v(),a=r("form"),f=r("label"),_=r("strong"),S=D("Username"),k=v(),h=r("input"),B=v(),y=r("label"),N=r("strong"),G=D("Password"),j=v(),m=r("input"),M=v(),O=r("label"),C=r("strong"),U=D("Confirm Password"),V=v(),P=r("input"),K=v(),$=r("br"),E=v(),I=r("button"),z=D("Register"),this.h()},l(R){t=n(R,"DIV",{class:!0});var g=p(t);l=n(g,"HEADER",{});var Q=p(l);o=n(Q,"H2",{});var W=p(o);s=F(W,"Register"),W.forEach(u),Q.forEach(u),d=b(g),w=n(g,"HR",{}),i=b(g),a=n(g,"FORM",{});var A=p(a);f=n(A,"LABEL",{});var Y=p(f);_=n(Y,"STRONG",{});var se=p(_);S=F(se,"Username"),se.forEach(u),k=b(Y),h=n(Y,"INPUT",{type:!0}),Y.forEach(u),B=b(A),y=n(A,"LABEL",{});var Z=p(y);N=n(Z,"STRONG",{});var le=p(N);G=F(le,"Password"),le.forEach(u),j=b(Z),m=n(Z,"INPUT",{type:!0}),Z.forEach(u),M=b(A),O=n(A,"LABEL",{});var x=p(O);C=n(x,"STRONG",{});var oe=p(C);U=F(oe,"Confirm Password"),oe.forEach(u),V=b(x),P=n(x,"INPUT",{type:!0}),x.forEach(u),K=b(A),$=n(A,"BR",{}),E=b(A),I=n(A,"BUTTON",{class:!0,type:!0});var ie=p(I);z=F(ie,"Register"),ie.forEach(u),A.forEach(u),g.forEach(u),this.h()},h(){T(h,"type","text"),T(m,"type","password"),T(P,"type","password"),T(I,"class","is-full-width"),T(I,"type","submit"),T(t,"class","card svelte-6fs8o2")},m(R,g){ne(R,t,g),e(t,l),e(l,o),e(o,s),e(t,d),e(t,w),e(t,i),e(t,a),e(a,f),e(f,_),e(_,S),e(f,k),e(f,h),H(h,c[0]),e(a,B),e(a,y),e(y,N),e(N,G),e(y,j),e(y,m),H(m,c[1]),e(a,M),e(a,O),e(O,C),e(C,U),e(O,V),e(O,P),H(P,c[2]),e(a,K),e(a,$),e(a,E),e(a,I),e(I,z),L||(q=[J(h,"input",c[4]),J(m,"input",c[5]),J(P,"input",c[6]),J(a,"submit",ge(c[3]))],L=!0)},p(R,[g]){g&1&&h.value!==R[0]&&H(h,R[0]),g&2&&m.value!==R[1]&&H(m,R[1]),g&4&&P.value!==R[2]&&H(P,R[2])},i:X,o:X,d(R){R&&u(t),L=!1,ve(q)}}}function Le(c,t,l){let o="",s="",d="";async function w(){if(s.trim().length===0){alert("Password cannot be empty");return}if(s!==d){alert("Passwords do not match");return}let _=new FormData;if(_.append("username",o),_.append("password",s),(await fetch(ee.register,{method:"POST",body:_})).ok){alert("Registration successful");let k=await fetch(ee.login,{method:"POST",body:_});if(k.ok){let h=await k.json();be.set(h.access_token);let B=document.referrer;await we(B.length>0?B:"/",{replaceState:!0}),location.reload();return}else{alert("Login failed. Please try to manually login."),location.reload();return}}else alert("Registration failed. Please try again.")}function i(){o=this.value,l(0,o)}function a(){s=this.value,l(1,s)}function f(){d=this.value,l(2,d)}return[o,s,d,w,i,a,f]}class Te extends te{constructor(t){super(),ae(this,t,Le,Pe,re,{})}}function Se(c){let t,l,o,s,d,w;return l=new $e({}),s=new Te({}),{c(){t=r("div"),ue(l.$$.fragment),o=v(),ue(s.$$.fragment),this.h()},l(i){t=n(i,"DIV",{class:!0});var a=p(t);de(l.$$.fragment,a),o=b(a),de(s.$$.fragment,a),a.forEach(u),this.h()},h(){T(t,"class","background svelte-jf0ycf")},m(i,a){ne(i,t,a),fe(l,t,null),e(t,o),fe(s,t,null),w=!0},p:X,i(i){w||(pe(l.$$.fragment,i),pe(s.$$.fragment,i),ye(()=>{d||(d=he(t,me,{},!0)),d.run(1)}),w=!0)},o(i){ce(l.$$.fragment,i),ce(s.$$.fragment,i),d||(d=he(t,me,{},!1)),d.run(0),w=!1},d(i){i&&u(t),_e(l),_e(s),i&&d&&d.end()}}}class ke extends te{constructor(t){super(),ae(this,t,null,Se,re,{})}}export{ke as default};
