import{S as te,i as ae,s as re,k as r,q as C,a as v,l as n,m as p,r as F,h as i,c as b,n as w,b as ne,F as e,M as D,I as q,J as ge,A as X,K as ve,v as ue,w as de,x as ce,f as fe,O as Ee,t as pe,P as he,y as _e}from"../../../chunks/index-4a37e229.js";import{a as me}from"../../../chunks/index-2f589274.js";import{U as ee,a as be,b as we}from"../../../chunks/tokens-fb3bf98c.js";function ye(_){let a,o,s,u,f,h,E,t,l,d,I,L,c,k,y,O,G,j,m,z,U,H,N,V,T,J;return{c(){a=r("div"),o=r("header"),s=r("h2"),u=C("Login"),f=v(),h=r("hr"),E=v(),t=r("form"),l=r("label"),d=r("strong"),I=C("Username"),L=v(),c=r("input"),k=v(),y=r("label"),O=r("strong"),G=C("Password"),j=v(),m=r("input"),z=v(),U=r("br"),H=v(),N=r("button"),V=C("Login"),this.h()},l($){a=n($,"DIV",{class:!0});var R=p(a);o=n(R,"HEADER",{});var A=p(o);s=n(A,"H2",{});var K=p(s);u=F(K,"Login"),K.forEach(i),A.forEach(i),f=b(R),h=n(R,"HR",{}),E=b(R),t=n(R,"FORM",{});var S=p(t);l=n(S,"LABEL",{});var M=p(l);d=n(M,"STRONG",{});var P=p(d);I=F(P,"Username"),P.forEach(i),L=b(M),c=n(M,"INPUT",{type:!0,autocapitalize:!0,autocorrect:!0}),M.forEach(i),k=b(S),y=n(S,"LABEL",{});var g=p(y);O=n(g,"STRONG",{});var Q=p(O);G=F(Q,"Password"),Q.forEach(i),j=b(g),m=n(g,"INPUT",{type:!0}),g.forEach(i),z=b(S),U=n(S,"BR",{}),H=b(S),N=n(S,"BUTTON",{class:!0,type:!0});var W=p(N);V=F(W,"Login"),W.forEach(i),S.forEach(i),R.forEach(i),this.h()},h(){w(c,"type","text"),w(c,"autocapitalize","none"),w(c,"autocorrect","off"),w(m,"type","password"),w(N,"class","is-full-width"),w(N,"type","submit"),w(a,"class","card svelte-6fs8o2")},m($,R){ne($,a,R),e(a,o),e(o,s),e(s,u),e(a,f),e(a,h),e(a,E),e(a,t),e(t,l),e(l,d),e(d,I),e(l,L),e(l,c),D(c,_[0]),e(t,k),e(t,y),e(y,O),e(O,G),e(y,j),e(y,m),D(m,_[1]),e(t,z),e(t,U),e(t,H),e(t,N),e(N,V),T||(J=[q(c,"input",_[3]),q(m,"input",_[4]),q(t,"submit",ge(_[2]))],T=!0)},p($,[R]){R&1&&c.value!==$[0]&&D(c,$[0]),R&2&&m.value!==$[1]&&D(m,$[1])},i:X,o:X,d($){$&&i(a),T=!1,ve(J)}}}function Re(_,a,o){let s="",u="";async function f(){let t=new FormData;t.append("username",s),t.append("password",u);let l=await fetch(ee.login,{method:"POST",body:t,credentials:"include"});if(l.ok){let I=await l.json();be.set(I.access_token);let L=document.referrer;await we(L.length>0?L:"/",{replaceState:!0}),location.reload();return}let d=await l.json();alert(`Login failed: ${d.detail||"Try Again"}`),o(1,u="")}function h(){s=this.value,o(0,s)}function E(){u=this.value,o(1,u)}return[s,u,f,h,E]}class Pe extends te{constructor(a){super(),ae(this,a,Re,ye,re,{})}}function $e(_){let a,o,s,u,f,h,E,t,l,d,I,L,c,k,y,O,G,j,m,z,U,H,N,V,T,J,$,R,A,K,S,M;return{c(){a=r("div"),o=r("header"),s=r("h2"),u=C("Register"),f=v(),h=r("hr"),E=v(),t=r("form"),l=r("label"),d=r("strong"),I=C("Username"),L=v(),c=r("input"),k=v(),y=r("label"),O=r("strong"),G=C("Password"),j=v(),m=r("input"),z=v(),U=r("label"),H=r("strong"),N=C("Confirm Password"),V=v(),T=r("input"),J=v(),$=r("br"),R=v(),A=r("button"),K=C("Register"),this.h()},l(P){a=n(P,"DIV",{class:!0});var g=p(a);o=n(g,"HEADER",{});var Q=p(o);s=n(Q,"H2",{});var W=p(s);u=F(W,"Register"),W.forEach(i),Q.forEach(i),f=b(g),h=n(g,"HR",{}),E=b(g),t=n(g,"FORM",{});var B=p(t);l=n(B,"LABEL",{});var Y=p(l);d=n(Y,"STRONG",{});var se=p(d);I=F(se,"Username"),se.forEach(i),L=b(Y),c=n(Y,"INPUT",{type:!0,autocapitalize:!0,autocorrect:!0}),Y.forEach(i),k=b(B),y=n(B,"LABEL",{});var Z=p(y);O=n(Z,"STRONG",{});var oe=p(O);G=F(oe,"Password"),oe.forEach(i),j=b(Z),m=n(Z,"INPUT",{type:!0}),Z.forEach(i),z=b(B),U=n(B,"LABEL",{});var x=p(U);H=n(x,"STRONG",{});var le=p(H);N=F(le,"Confirm Password"),le.forEach(i),V=b(x),T=n(x,"INPUT",{type:!0}),x.forEach(i),J=b(B),$=n(B,"BR",{}),R=b(B),A=n(B,"BUTTON",{class:!0,type:!0});var ie=p(A);K=F(ie,"Register"),ie.forEach(i),B.forEach(i),g.forEach(i),this.h()},h(){w(c,"type","text"),w(c,"autocapitalize","none"),w(c,"autocorrect","off"),w(m,"type","password"),w(T,"type","password"),w(A,"class","is-full-width"),w(A,"type","submit"),w(a,"class","card svelte-6fs8o2")},m(P,g){ne(P,a,g),e(a,o),e(o,s),e(s,u),e(a,f),e(a,h),e(a,E),e(a,t),e(t,l),e(l,d),e(d,I),e(l,L),e(l,c),D(c,_[0]),e(t,k),e(t,y),e(y,O),e(O,G),e(y,j),e(y,m),D(m,_[1]),e(t,z),e(t,U),e(U,H),e(H,N),e(U,V),e(U,T),D(T,_[2]),e(t,J),e(t,$),e(t,R),e(t,A),e(A,K),S||(M=[q(c,"input",_[4]),q(m,"input",_[5]),q(T,"input",_[6]),q(t,"submit",ge(_[3]))],S=!0)},p(P,[g]){g&1&&c.value!==P[0]&&D(c,P[0]),g&2&&m.value!==P[1]&&D(m,P[1]),g&4&&T.value!==P[2]&&D(T,P[2])},i:X,o:X,d(P){P&&i(a),S=!1,ve(M)}}}function Le(_,a,o){let s="",u="",f="";async function h(){if(u.trim().length===0){alert("Password cannot be empty");return}if(u!==f){alert("Passwords do not match");return}let d=new FormData;if(d.append("username",s),d.append("password",u),(await fetch(ee.register,{method:"POST",body:d})).ok){alert("Registration successful");let L=await fetch(ee.login,{method:"POST",body:d});if(L.ok){let c=await L.json();be.set(c.access_token);let k=document.referrer;await we(k.length>0?k:"/",{replaceState:!0}),location.reload();return}else{alert("Login failed. Please try to manually login."),location.reload();return}}else alert("Registration failed. Please try again.")}function E(){s=this.value,o(0,s)}function t(){u=this.value,o(1,u)}function l(){f=this.value,o(2,f)}return[s,u,f,h,E,t,l]}class Te extends te{constructor(a){super(),ae(this,a,Le,$e,re,{})}}function Se(_){let a,o,s,u,f,h,E;return s=new Pe({}),f=new Te({}),{c(){a=r("div"),o=r("div"),ue(s.$$.fragment),u=v(),ue(f.$$.fragment),this.h()},l(t){a=n(t,"DIV",{class:!0});var l=p(a);o=n(l,"DIV",{class:!0});var d=p(o);de(s.$$.fragment,d),u=b(d),de(f.$$.fragment,d),d.forEach(i),l.forEach(i),this.h()},h(){w(o,"class","grid svelte-u9ie7r"),w(a,"class","background svelte-u9ie7r")},m(t,l){ne(t,a,l),e(a,o),ce(s,o,null),e(o,u),ce(f,o,null),E=!0},p:X,i(t){E||(fe(s.$$.fragment,t),fe(f.$$.fragment,t),Ee(()=>{h||(h=he(a,me,{},!0)),h.run(1)}),E=!0)},o(t){pe(s.$$.fragment,t),pe(f.$$.fragment,t),h||(h=he(a,me,{},!1)),h.run(0),E=!1},d(t){t&&i(a),_e(s),_e(f),t&&h&&h.end()}}}class Ie extends te{constructor(a){super(),ae(this,a,null,Se,re,{})}}export{Ie as default};
