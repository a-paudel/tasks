import{S as te,i as ae,s as re,k as r,q as D,a as v,l as n,m as p,r as j,h as u,c as b,n as S,b as ne,F as e,M as H,I as J,J as ge,A as X,K as ve,v as ue,w as de,x as fe,f as pe,N as ye,t as ce,O as he,y as _e}from"../../../chunks/index-f7b1ee1a.js";import{a as me}from"../../../chunks/index-5d397866.js";import{U as ee,a as be,b as we}from"../../../chunks/tokens-915d9474.js";function Ee(c){let t,l,o,s,d,w,i,a,f,_,k,$,h,A,y,N,F,G,m,M,O,C,U,V,L,K;return{c(){t=r("div"),l=r("header"),o=r("h2"),s=D("Login"),d=v(),w=r("hr"),i=v(),a=r("form"),f=r("label"),_=r("strong"),k=D("Username"),$=v(),h=r("input"),A=v(),y=r("label"),N=r("strong"),F=D("Password"),G=v(),m=r("input"),M=v(),O=r("br"),C=v(),U=r("button"),V=D("Login"),this.h()},l(P){t=n(P,"DIV",{class:!0});var E=p(t);l=n(E,"HEADER",{});var B=p(l);o=n(B,"H2",{});var z=p(o);s=j(z,"Login"),z.forEach(u),B.forEach(u),d=b(E),w=n(E,"HR",{}),i=b(E),a=n(E,"FORM",{});var T=p(a);f=n(T,"LABEL",{});var q=p(f);_=n(q,"STRONG",{});var R=p(_);k=j(R,"Username"),R.forEach(u),$=b(q),h=n(q,"INPUT",{type:!0}),q.forEach(u),A=b(T),y=n(T,"LABEL",{});var g=p(y);N=n(g,"STRONG",{});var Q=p(N);F=j(Q,"Password"),Q.forEach(u),G=b(g),m=n(g,"INPUT",{type:!0}),g.forEach(u),M=b(T),O=n(T,"BR",{}),C=b(T),U=n(T,"BUTTON",{class:!0,type:!0});var W=p(U);V=j(W,"Login"),W.forEach(u),T.forEach(u),E.forEach(u),this.h()},h(){S(h,"type","text"),S(m,"type","password"),S(U,"class","is-full-width"),S(U,"type","submit"),S(t,"class","card svelte-6fs8o2")},m(P,E){ne(P,t,E),e(t,l),e(l,o),e(o,s),e(t,d),e(t,w),e(t,i),e(t,a),e(a,f),e(f,_),e(_,k),e(f,$),e(f,h),H(h,c[0]),e(a,A),e(a,y),e(y,N),e(N,F),e(y,G),e(y,m),H(m,c[1]),e(a,M),e(a,O),e(a,C),e(a,U),e(U,V),L||(K=[J(h,"input",c[3]),J(m,"input",c[4]),J(a,"submit",ge(c[2]))],L=!0)},p(P,[E]){E&1&&h.value!==P[0]&&H(h,P[0]),E&2&&m.value!==P[1]&&H(m,P[1])},i:X,o:X,d(P){P&&u(t),L=!1,ve(K)}}}function Re(c,t,l){let o="",s="";async function d(){let a=new FormData;a.append("username",o),a.append("password",s);let f=await fetch(ee.login,{method:"POST",body:a,credentials:"include"});if(f.ok){let k=await f.json();be.set(k.access_token);let $=document.referrer;await we($.length>0?$:"/",{replaceState:!0}),location.reload();return}let _=await f.json();alert(`Login failed: ${_.detail||"Try Again"}`),l(1,s="")}function w(){o=this.value,l(0,o)}function i(){s=this.value,l(1,s)}return[o,s,d,w,i]}class Pe extends te{constructor(t){super(),ae(this,t,Re,Ee,re,{})}}function $e(c){let t,l,o,s,d,w,i,a,f,_,k,$,h,A,y,N,F,G,m,M,O,C,U,V,L,K,P,E,B,z,T,q;return{c(){t=r("div"),l=r("header"),o=r("h2"),s=D("Register"),d=v(),w=r("hr"),i=v(),a=r("form"),f=r("label"),_=r("strong"),k=D("Username"),$=v(),h=r("input"),A=v(),y=r("label"),N=r("strong"),F=D("Password"),G=v(),m=r("input"),M=v(),O=r("label"),C=r("strong"),U=D("Confirm Password"),V=v(),L=r("input"),K=v(),P=r("br"),E=v(),B=r("button"),z=D("Register"),this.h()},l(R){t=n(R,"DIV",{class:!0});var g=p(t);l=n(g,"HEADER",{});var Q=p(l);o=n(Q,"H2",{});var W=p(o);s=j(W,"Register"),W.forEach(u),Q.forEach(u),d=b(g),w=n(g,"HR",{}),i=b(g),a=n(g,"FORM",{});var I=p(a);f=n(I,"LABEL",{});var Y=p(f);_=n(Y,"STRONG",{});var se=p(_);k=j(se,"Username"),se.forEach(u),$=b(Y),h=n(Y,"INPUT",{type:!0}),Y.forEach(u),A=b(I),y=n(I,"LABEL",{});var Z=p(y);N=n(Z,"STRONG",{});var le=p(N);F=j(le,"Password"),le.forEach(u),G=b(Z),m=n(Z,"INPUT",{type:!0}),Z.forEach(u),M=b(I),O=n(I,"LABEL",{});var x=p(O);C=n(x,"STRONG",{});var oe=p(C);U=j(oe,"Confirm Password"),oe.forEach(u),V=b(x),L=n(x,"INPUT",{type:!0}),x.forEach(u),K=b(I),P=n(I,"BR",{}),E=b(I),B=n(I,"BUTTON",{class:!0,type:!0});var ie=p(B);z=j(ie,"Register"),ie.forEach(u),I.forEach(u),g.forEach(u),this.h()},h(){S(h,"type","text"),S(m,"type","password"),S(L,"type","password"),S(B,"class","is-full-width"),S(B,"type","submit"),S(t,"class","card svelte-6fs8o2")},m(R,g){ne(R,t,g),e(t,l),e(l,o),e(o,s),e(t,d),e(t,w),e(t,i),e(t,a),e(a,f),e(f,_),e(_,k),e(f,$),e(f,h),H(h,c[0]),e(a,A),e(a,y),e(y,N),e(N,F),e(y,G),e(y,m),H(m,c[1]),e(a,M),e(a,O),e(O,C),e(C,U),e(O,V),e(O,L),H(L,c[2]),e(a,K),e(a,P),e(a,E),e(a,B),e(B,z),T||(q=[J(h,"input",c[4]),J(m,"input",c[5]),J(L,"input",c[6]),J(a,"submit",ge(c[3]))],T=!0)},p(R,[g]){g&1&&h.value!==R[0]&&H(h,R[0]),g&2&&m.value!==R[1]&&H(m,R[1]),g&4&&L.value!==R[2]&&H(L,R[2])},i:X,o:X,d(R){R&&u(t),T=!1,ve(q)}}}function Le(c,t,l){let o="",s="",d="";async function w(){if(s.trim().length===0){alert("Password cannot be empty");return}if(s!==d){alert("Passwords do not match");return}let _=new FormData;if(_.append("username",o),_.append("password",s),(await fetch(ee.register,{method:"POST",body:_})).ok){alert("Registration successful");let $=await fetch(ee.login,{method:"POST",body:_});if($.ok){let h=await $.json();be.set(h.access_token);let A=document.referrer;await we(A.length>0?A:"/",{replaceState:!0}),location.reload();return}else{alert("Login failed. Please try to manually login."),location.reload();return}}else alert("Registration failed. Please try again.")}function i(){o=this.value,l(0,o)}function a(){s=this.value,l(1,s)}function f(){d=this.value,l(2,d)}return[o,s,d,w,i,a,f]}class Te extends te{constructor(t){super(),ae(this,t,Le,$e,re,{})}}function Se(c){let t,l,o,s,d,w;return l=new Pe({}),s=new Te({}),{c(){t=r("div"),ue(l.$$.fragment),o=v(),ue(s.$$.fragment),this.h()},l(i){t=n(i,"DIV",{class:!0});var a=p(t);de(l.$$.fragment,a),o=b(a),de(s.$$.fragment,a),a.forEach(u),this.h()},h(){S(t,"class","background svelte-jf0ycf")},m(i,a){ne(i,t,a),fe(l,t,null),e(t,o),fe(s,t,null),w=!0},p:X,i(i){w||(pe(l.$$.fragment,i),pe(s.$$.fragment,i),ye(()=>{d||(d=he(t,me,{},!0)),d.run(1)}),w=!0)},o(i){ce(l.$$.fragment,i),ce(s.$$.fragment,i),d||(d=he(t,me,{},!1)),d.run(0),w=!1},d(i){i&&u(t),_e(l),_e(s),i&&d&&d.end()}}}class ke extends te{constructor(t){super(),ae(this,t,null,Se,re,{})}}export{ke as default};
