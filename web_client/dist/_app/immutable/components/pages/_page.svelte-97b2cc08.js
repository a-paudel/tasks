import{S as x,i as ee,s as te,k as v,a as P,q as H,l as k,m as y,c as S,r as A,h as d,n as g,H as j,b as I,F as f,I as B,J as ae,u as z,A as F,K as le,f as V,d as re,t as M,L as oe,v as ne,w as ce,x as ue,y as ie,g as fe}from"../../chunks/index-f7b1ee1a.js";import{d as se,l as he}from"../../chunks/database-4df4be65.js";import{a as de,U as _e,g as pe}from"../../chunks/tokens-57bcebed.js";function me(c){let s,a,e,l,i,u=c[0].task+"",E,p,m,D,w,L,C,_,n,O,h,t,r,o=G(c[0].due)+"",T,N,Q;return{c(){s=v("div"),a=v("header"),e=v("h3"),l=v("input"),i=P(),E=H(u),p=P(),m=v("div"),D=v("a"),w=H("Edit"),C=P(),_=v("a"),n=H("Delete"),h=P(),t=v("p"),r=H("Due by: "),T=H(o),this.h()},l($){s=k($,"DIV",{class:!0});var b=y(s);a=k(b,"HEADER",{});var J=y(a);e=k(J,"H3",{class:!0});var R=y(e);l=k(R,"INPUT",{type:!0,class:!0}),i=S(R),E=A(R,u),p=S(R),m=k(R,"DIV",{class:!0});var U=y(m);D=k(U,"A",{href:!0,class:!0});var K=y(D);w=A(K,"Edit"),K.forEach(d),C=S(U),_=k(U,"A",{href:!0,class:!0});var Y=y(_);n=A(Y,"Delete"),Y.forEach(d),U.forEach(d),R.forEach(d),J.forEach(d),h=S(b),t=k(b,"P",{class:!0});var q=y(t);r=A(q,"Due by: "),T=A(q,o),q.forEach(d),b.forEach(d),this.h()},h(){g(l,"type","checkbox"),g(l,"class","svelte-1e9f8ah"),g(D,"href",L="/update/"+c[0].id),g(D,"class","button"),g(_,"href",O="/delete/"+c[0].id),g(_,"class","error button"),g(m,"class","pull-right"),g(e,"class","svelte-1e9f8ah"),j(e,"done",c[0].done),g(t,"class","text-grey"),g(s,"class","card svelte-1e9f8ah")},m($,b){I($,s,b),f(s,a),f(a,e),f(e,l),l.checked=c[0].done,f(e,i),f(e,E),f(e,p),f(e,m),f(m,D),f(D,w),f(m,C),f(m,_),f(_,n),f(s,h),f(s,t),f(t,r),f(t,T),N||(Q=[B(l,"change",c[2]),B(l,"click",ae(c[1]))],N=!0)},p($,[b]){b&1&&(l.checked=$[0].done),b&1&&u!==(u=$[0].task+"")&&z(E,u),b&1&&L!==(L="/update/"+$[0].id)&&g(D,"href",L),b&1&&O!==(O="/delete/"+$[0].id)&&g(_,"href",O),b&1&&j(e,"done",$[0].done),b&1&&o!==(o=G($[0].due)+"")&&z(T,o)},i:F,o:F,d($){$&&d(s),N=!1,le(Q)}}}function G(c){let s=new Date(c),a=s.getFullYear(),e=("0"+(s.getMonth()+1)).slice(-2),l=("0"+s.getDate()).slice(-2),i=("0"+s.getHours()).slice(-2),u=("0"+s.getMinutes()).slice(-2);return`${a}/${e}/${l} ${i}:${u}`}function ge(c,s,a){let{task:e}=s;function l(){a(0,e.done=!e.done,e),a(0,e.synced=!1,e),se.tasks.update(e.id,e)}function i(){e.done=this.checked,a(0,e)}return c.$$set=u=>{"task"in u&&a(0,e=u.task)},[e,l,i]}class ve extends x{constructor(s){super(),ee(this,s,ge,me,te,{task:0})}}function W(c,s,a){const e=c.slice();return e[3]=s[a],e}function X(c){let s,a,e,l;return{c(){s=v("div"),a=v("header"),e=v("h3"),l=H("No tasks found"),this.h()},l(i){s=k(i,"DIV",{class:!0});var u=y(s);a=k(u,"HEADER",{});var E=y(a);e=k(E,"H3",{class:!0});var p=y(e);l=A(p,"No tasks found"),p.forEach(d),E.forEach(d),u.forEach(d),this.h()},h(){g(e,"class","text-center text-grey"),g(s,"class","card")},m(i,u){I(i,s,u),f(s,a),f(a,e),f(e,l)},p:F,d(i){i&&d(s)}}}function Z(c){let s,a;return s=new ve({props:{task:c[3]}}),{c(){ne(s.$$.fragment)},l(e){ce(s.$$.fragment,e)},m(e,l){ue(s,e,l),a=!0},p(e,l){const i={};l&1&&(i.task=e[3]),s.$set(i)},i(e){a||(V(s.$$.fragment,e),a=!0)},o(e){M(s.$$.fragment,e),a=!1},d(e){ie(s,e)}}}function ke(c){let s,a,e,l,i,u,E,p,m,D,w,L,C,_=c[0],n=[];for(let t=0;t<_.length;t+=1)n[t]=Z(W(c,_,t));const O=t=>M(n[t],1,1,()=>{n[t]=null});let h=null;return _.length||(h=X()),{c(){s=v("h1"),a=H(`Tasks
    `),e=v("a"),l=H("Add Task"),i=P(),u=v("hr"),E=P();for(let t=0;t<n.length;t+=1)n[t].c();h&&h.c(),p=P(),m=v("button"),D=H("Logout"),this.h()},l(t){s=k(t,"H1",{});var r=y(s);a=A(r,`Tasks
    `),e=k(r,"A",{href:!0,class:!0});var o=y(e);l=A(o,"Add Task"),o.forEach(d),r.forEach(d),i=S(t),u=k(t,"HR",{}),E=S(t);for(let N=0;N<n.length;N+=1)n[N].l(t);h&&h.l(t),p=S(t),m=k(t,"BUTTON",{class:!0});var T=y(m);D=A(T,"Logout"),T.forEach(d),this.h()},h(){g(e,"href","/create"),g(e,"class","primary button pull-right"),g(m,"class","logout-button svelte-1ggum3m")},m(t,r){I(t,s,r),f(s,a),f(s,e),f(e,l),I(t,i,r),I(t,u,r),I(t,E,r);for(let o=0;o<n.length;o+=1)n[o].m(t,r);h&&h.m(t,r),I(t,p,r),I(t,m,r),f(m,D),w=!0,L||(C=B(m,"click",c[1]),L=!0)},p(t,[r]){if(r&1){_=t[0];let o;for(o=0;o<_.length;o+=1){const T=W(t,_,o);n[o]?(n[o].p(T,r),V(n[o],1)):(n[o]=Z(T),n[o].c(),V(n[o],1),n[o].m(p.parentNode,p))}for(fe(),o=_.length;o<n.length;o+=1)O(o);re(),!_.length&&h?h.p(t,r):_.length?h&&(h.d(1),h=null):(h=X(),h.c(),h.m(p.parentNode,p))}},i(t){if(!w){for(let r=0;r<_.length;r+=1)V(n[r]);w=!0}},o(t){n=n.filter(Boolean);for(let r=0;r<n.length;r+=1)M(n[r]);w=!1},d(t){t&&d(s),t&&d(i),t&&d(u),t&&d(E),oe(n,t),h&&h.d(t),t&&d(p),t&&d(m),L=!1,C()}}}function Ee(c,s,a){const e=he(()=>se.tasks.toArray());let l=[];e.subscribe(u=>{u.sort((E,p)=>new Date(E.due).valueOf()-new Date(p.due).valueOf()),a(0,l=u)});async function i(){de.set(null),(await fetch(_e.logout,{method:"POST",credentials:"include",headers:await pe()})).ok?(localStorage.removeItem("lastPulled"),location.reload()):alert("Logout failed. Please try again.")}return[l,i]}class $e extends x{constructor(s){super(),ee(this,s,Ee,ke,te,{})}}export{$e as default};
